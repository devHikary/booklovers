<div class="container mt-4">
  <div class="card bg-card p-4">
    <div class="row text-center">
      <div class="col-12 mb-2">
        <h2>Sobre o livro <a title="Editar informações do livro" href="javascript:;" (click)="editBook(book.id)">
            <i class="bi bi-pencil-square"></i>
          </a></h2>

      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <div class="row">
          <div class="col-7 d-flex justify-content-end pe-0">
            <ng-template #t let-fill="fill">
              <i class="bi-star-fill">
                <i *ngIf="fill > 0" class="bi-star-fill filled" [style.width.%]="fill"></i>
              </i>
            </ng-template>

            <ngb-rating [(rate)]="annotationObj.rating" [starTemplate]="t" [readonly]="false" [max]="5"
              [ariaValueText]="ariaValueText"></ngb-rating>
          </div>
          <div class="col-5 ps-5">
            <a title="Favoritar o livro" href="javascript:;" (click)="toggleFavorite()">
              <i class="bi-heart-fill" [class]="annotationObj.favorite == 1? 'filled-heart' : ''"></i>
            </a>
          </div>
        </div>
        <div class="row text-center">
          <img class="w-50 mx-auto" [src]="book.thumbnail" alt="thumbnail">
        </div>
        <div class="row p-4">
          <p class="fw-semibold text-muted">Sinopse:</p>
          <div class="card scrollCard" style="height: 160px">
            <p class="text-wrap" placeholder="Leave a comment here" id="description" style="height: 100px">
              {{book.description}}</p>

          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="row">
          <div class="col-md-12  ">
            <p class=" text-muted text-capitalize mb-1">
              <span class="fw-semibold">Título: </span>
              {{book.title}}
            </p>

          </div>
          <div class="col-md-12  " *ngIf="book.subtitle != ''">
            <p class=" text-muted text-capitalize mb-1">
              <span class="fw-semibold">Subtítulo: </span>
              {{book.subtitle}}
            </p>
          </div>
          <div class="col-md-12  ">
            <p class="fw-semibold text-muted mb-1">Autores:
              <span class="fw-normal" *ngFor="let author of book.authors">
                {{author.name + "; "}}
              </span>
            </p>

          </div>


          <div class="col-md-6  ">
            <p class=" text-muted text-capitalize mb-1">
              <span class="fw-semibold">Editora: </span>
              {{book.publisher}}
            </p>
          </div>

          <div class="col-md-6  ">
            <p class=" text-muted mb-1">
              <span class="fw-semibold">Publicação: </span>
              {{book.release_dt}}
            </p>
          </div>

          <div class="col-md-6  ">
            <p class=" text-muted mb-1">
              <span class="fw-semibold">Páginas: </span>
              {{book.pages}}
            </p>
          </div>

          <div class="col-md-6  ">
            <p class=" text-muted mb-1">
              <span class="fw-semibold">ISBN 13: </span>
              {{book.isbn_13}}
            </p>
          </div>


          <div class="col-md-6  ">
            <p class="fw-semibold text-muted mb-1">Temas:
              <span class="fw-normal" *ngFor="let theme of book.themes">
                {{theme.name + "; "}}
              </span>
            </p>
          </div>
          <hr>
        </div>
        <form class="row">
          <h4>Minhas Anotações</h4>

          <div class="col-md-12 pb-2">
            <label for="review" class="form-label">Citação/ avaliação </label>
            <textarea class="form-control" placeholder="Leave a review here" id="review" name="review"
              [(ngModel)]="annotationObj.review" style="height: 200px"></textarea>
          </div>

          <div class="col-md-6 pb-2">
            <label for="dpFromDate" class="form-label">Data de Início
            </label>
            <div class="dp-hidden position-absolute">

              <div class="input-group">
                <input name="datepicker" class="form-control" ngbDatepicker #datepicker="ngbDatepicker"
                  [autoClose]="'outside'" (dateSelect)="onDateSelection($event)" [displayMonths]="2" [dayTemplate]="b"
                  outsideDays="hidden" [startDate]="fromDate!" tabindex="-1" />
                <ng-template #b let-date let-focused="focused">
                  <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                    [class.faded]="isHovered(date) || isInside(date)" (mouseenter)="hoveredDate = date"
                    (mouseleave)="hoveredDate = null">
                    {{ date.day }}
                  </span>
                </ng-template>
              </div>
            </div>

            <div class="input-group">
              <input #dpFromDate class="form-control" placeholder="yyyy-mm-dd" name="dpFromDate"
                [value]="formatter.format(fromDate)" (input)="fromDate = validateInput(fromDate, dpFromDate.value)" />
              <button class="btn btn-outline-secondary bi bi-calendar3" (click)="datepicker.toggle()"
                type="button"></button>
            </div>
          </div>
          <div class="col-md-6 pb-2">
            <label for="dpToDate" class="form-label">Data de Fim
            </label>
            <div class="input-group">
              <input #dpToDate class="form-control" placeholder="yyyy-mm-dd" name="dpToDate"
                [value]="formatter.format(toDate)" (input)="toDate = validateInput(toDate, dpToDate.value)" />
              <button class="btn btn-outline-secondary bi bi-calendar3" (click)="datepicker.toggle()"
                type="button"></button>
            </div>
          </div>

          <div class="col-md-6 pb-2">
            <label for="page_read" class="form-label">Páginas lidas
            </label>
            <input type="number" class="form-control" id="page_read" [(ngModel)]="annotationObj.page_read"
              name="page_read" maxlength="14" (change)="pages_readChanged()" max="{{book.pages}}" min="0">
          </div>
          <div class="col-md-6 pb-2">
            <label for="percent" class="form-label">Porcentagem
            </label>
            <div class="input-group">
              <input type="number" class="form-control" id="percent" [(ngModel)]="annotationObj.progress" name="percent"
                maxlength="14" (change)="percentChanged()" max="100" min="0">
              <span class="input-group-text">%</span>
            </div>
          </div>
          <div class="col-md-12 pb-2">
            <label for="progress" class="form-label">Progresso
            </label>
            <ngb-progressbar type="secondary" textType="light" [value]="annotationObj.progress"
              [showValue]="true"></ngb-progressbar>
          </div>
        </form>
      </div>

    </div>

    <div class="row mt-4">
      <div class="col">
        <button class="btn btn-light" (click)="cancel()">Cancelar</button>
      </div>
      <div class="col d-flex justify-content-end">
        <button class="btn btn-secondary" (click)="save()">Salvar</button>
      </div>
    </div>
    <!-- <label class="image-upload-container btn btn-bwm">
      <span>Select Image</span>
      <input #imageInput type="file" accept="image/*" (change)="processFile(imageInput)">
    </label> -->
  </div>
</div>
